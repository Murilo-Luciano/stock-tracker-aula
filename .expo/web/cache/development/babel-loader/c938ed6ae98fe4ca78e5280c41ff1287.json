{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { Duck } from \"./Duck\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nvar AuthenticationDuck = function (_Duck) {\n  _inherits(AuthenticationDuck, _Duck);\n\n  var _super = _createSuper(AuthenticationDuck);\n\n  function AuthenticationDuck() {\n    var _this;\n\n    _classCallCheck(this, AuthenticationDuck);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.LOAD_TOKEN = _this.type(\"LOAD_TOKEN\");\n    _this.SIGN_OUT = _this.type(\"SIGN_OUT\");\n    _this.SIGN_IN = _this.type(\"SIGN_IN\");\n    return _this;\n  }\n\n  _createClass(AuthenticationDuck, [{\n    key: \"reducer\",\n    value: function reducer(state, action) {\n      if (!state) {\n        return this.initialState();\n      }\n\n      switch (action.type) {\n        case \"LOAD_TOKEN\":\n          return _objectSpread(_objectSpread({}, state), {}, {\n            authToken: action.token,\n            isLoading: false\n          });\n\n        case \"SIGN_IN\":\n          return _objectSpread(_objectSpread({}, state), {}, {\n            authToken: action.token,\n            isSignout: false\n          });\n\n        case \"SIGN_OUT\":\n          return _objectSpread(_objectSpread({}, state), {}, {\n            authToken: null,\n            isSignout: true\n          });\n\n        default:\n          return state;\n      }\n    }\n  }, {\n    key: \"signIn\",\n    value: function signIn() {\n      return function _callee(dispatch) {\n        var dummyToken;\n        return _regeneratorRuntime.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                dummyToken = \"12345678910\";\n                _context.next = 3;\n                return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"@auth_token\", dummyToken));\n\n              case 3:\n                dispatch({\n                  type: \"SIGN_IN\",\n                  token: dummyToken\n                });\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      };\n    }\n  }, {\n    key: \"signOut\",\n    value: function signOut() {}\n  }, {\n    key: \"initialState\",\n    value: function initialState() {\n      return {\n        isLoading: true,\n        authToken: null\n      };\n    }\n  }, {\n    key: \"namespace\",\n    value: function namespace() {\n      return \"stock-tracker\";\n    }\n  }, {\n    key: \"store\",\n    value: function store() {\n      return \"authentication\";\n    }\n  }]);\n\n  return AuthenticationDuck;\n}(Duck);\n\nexport var authenticationDuck = new AuthenticationDuck();","map":{"version":3,"sources":["/home/igor/Documentos/Programa de Formação Investtools/ReactNative/stock-tracker-aula/src/ducks/AuthenticationDuck.ts"],"names":["Duck","AsyncStorage","AuthenticationDuck","LOAD_TOKEN","type","SIGN_OUT","SIGN_IN","state","action","initialState","authToken","token","isLoading","isSignout","dispatch","dummyToken","setItem","authenticationDuck"],"mappings":";;;;;;;;;;;;;;;;AAAA,SAASA,IAAT;AAEA,OAAOC,YAAP,MAAyB,2CAAzB;;IAoBMC,kB;;;;;;;;;;;;;;;UACYC,U,GAAa,MAAKC,IAAL,CAAU,YAAV,C;UACbC,Q,GAAW,MAAKD,IAAL,CAAU,UAAV,C;UACXE,O,GAAU,MAAKF,IAAL,CAAU,SAAV,C;;;;;;WAE1B,iBAAeG,KAAf,EAAiCC,MAAjC,EAAiD;AAC/C,UAAG,CAACD,KAAJ,EAAU;AACR,eAAO,KAAKE,YAAL,EAAP;AACD;;AACF,cAAQD,MAAM,CAACJ,IAAf;AACG,aAAK,YAAL;AACE,iDACKG,KADL;AAEEG,YAAAA,SAAS,EAAGF,MAAD,CAA4BG,KAFzC;AAGEC,YAAAA,SAAS,EAAE;AAHb;;AAKF,aAAK,SAAL;AACE,iDACKL,KADL;AAEEG,YAAAA,SAAS,EAAGF,MAAD,CAAyBG,KAFtC;AAGEE,YAAAA,SAAS,EAAE;AAHb;;AAKF,aAAK,UAAL;AACE,iDACKN,KADL;AAEEG,YAAAA,SAAS,EAAE,IAFb;AAGEG,YAAAA,SAAS,EAAE;AAHb;;AAKF;AACE,iBAAON,KAAP;AApBL;AAsBA;;;WAED,kBAAe;AACb,aAAO,iBAAeO,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,gBAAAA,UADD,GACc,aADd;AAAA;AAAA,iDAECd,YAAY,CAACe,OAAb,CAAqB,aAArB,EAAoCD,UAApC,CAFD;;AAAA;AAGLD,gBAAAA,QAAQ,CAAC;AAACV,kBAAAA,IAAI,EAAE,SAAP;AAAkBO,kBAAAA,KAAK,EAAEI;AAAzB,iBAAD,CAAR;;AAHK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAP;AAMD;;;WAED,mBAAgB,CAEf;;;WAED,wBAAoC;AAClC,aAAO;AACLH,QAAAA,SAAS,EAAE,IADN;AAELF,QAAAA,SAAS,EAAE;AAFN,OAAP;AAID;;;WACD,qBAA8B;AAC5B,aAAO,eAAP;AACD;;;WAED,iBAA0B;AACxB,aAAO,gBAAP;AACD;;;;EA1D8BV,I;;AAiEjC,OAAO,IAAMiB,kBAAkB,GAAI,IAAIf,kBAAJ,EAA5B","sourcesContent":["import { Duck } from \"./Duck\";\nimport { Action } from \"redux\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\n\nexport interface AuthState {\n  isLoading: boolean;\n  authToken: string | null;\n}\n\ninterface LoadTokenAction extends Action<string> {\n  token: string | null;\n}\ntype SignOutAction = Action<string>;\n\n\ninterface SignInAction extends Action<string> {\n  token: string | null;\n}\n\ntype AuthAction = LoadTokenAction | SignOutAction | SignInAction;\n\nclass AuthenticationDuck extends Duck<AuthState, AuthAction> {\n  public readonly LOAD_TOKEN = this.type(\"LOAD_TOKEN\");\n  public readonly SIGN_OUT = this.type(\"SIGN_OUT\");\n  public readonly SIGN_IN = this.type(\"SIGN_IN\");\n\n  public reducer(state: AuthState, action: Action) {\n    if(!state){\n      return this.initialState()\n    } \n   switch (action.type) {\n      case \"LOAD_TOKEN\":\n        return {\n          ...state,\n          authToken: (action as LoadTokenAction).token,\n          isLoading: false,\n        };\n      case \"SIGN_IN\":\n        return {\n          ...state,\n          authToken: (action as SignInAction).token,\n          isSignout: false,\n        };\n      case \"SIGN_OUT\":\n        return {\n          ...state,\n          authToken: null,\n          isSignout: true,\n        };\n      default:\n        return state;\n    }\n  }\n\n  public signIn(){\n    return async function(dispatch:any){\n      const dummyToken = \"12345678910\";\n      await AsyncStorage.setItem(\"@auth_token\", dummyToken);\n      dispatch({type: \"SIGN_IN\", token: dummyToken});\n\n    }\n  }\n\n  public signOut(){\n\n  }\n\n  protected initialState(): AuthState {\n    return {\n      isLoading: true,\n      authToken: null,\n    };\n  }\n  protected namespace(): string {\n    return \"stock-tracker\";\n  }\n\n  protected store(): string {\n    return \"authentication\";\n  }\n\n  \n}\n\n\n\nexport const authenticationDuck =  new AuthenticationDuck()\n\n"]},"metadata":{},"sourceType":"module"}